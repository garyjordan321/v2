var initPostViewsCounterPro=function(){(PostViewsCounterPro={promise:null,args:{},init:function(t){if(this.args=t,this.loadViews(),!0!==t.contentActive||!t.content.hasOwnProperty("type")||!1==t.content.type)return;let e={subtype:t.content.subtype},a="pvc_visits"+("post"===t.content.type?"":"_"+t.content.type)+(!1!==t.multisite?"_"+parseInt(t.multisite):"");"cookieless"===t.dataStorage&&this.isLocalStorageAvailable()?(e.storage_type="cookieless",e.storage_data=this.readStorageData(a)):(e.storage_type="cookies",e.storage_data=this.readCookieData(a)),"rest_api"===t.mode?this.promise=this.request(t.requestURL,e,"POST",{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8","X-WP-Nonce":t.nonce},a):(e.action="pvcp-check-post",e.pvcp_nonce=t.nonce,e.content=t.content.data,e.type=t.content.type,this.promise=this.request(t.requestURL,e,"POST",{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},a))},request:function(t,e,a,o,n=""){let s={method:a,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:o};switch(a){case"HEAD":case"GET":break;default:s.body=this.prepareRequestData(e)}let i=this;return fetch(t,s).then(function(t){if(!t.ok)throw Error(t.statusText);return t.json()}).then(function(t){try{"object"==typeof t&&null!==t?"success"in t&&!1===t.success?console.log("Request error"):("cookieless"===i.args.dataStorage?i.saveStorageData.call(i,n,t.storage,t.type):i.saveCookieData(n,t.storage),i.triggerEvent("pvcCheckPost",t)):console.log("Invalid object")}catch(e){console.log("Invalid JSON data")}}).catch(function(t){console.log("Invalid response")})},prepareRequestData:function(t){return Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&").replace(/%20/g,"+")},triggerEvent:function(t,e){let a=new CustomEvent(t,{bubbles:!0,detail:e});document.dispatchEvent(a)},saveStorageData:function(t,e,a){window.localStorage.setItem(t,JSON.stringify(e[a]))},readStorageData:function(t){let e=null;return null===(e=window.localStorage.getItem(t))&&(e=""),e},saveCookieData:function(t,e){var a="";"https:"===document.location.protocol&&(a=";secure");for(let o=0;o<e.name.length;o++){var n=new Date,s=parseInt(e.expiry[o]);s?s*=1e3:s=n.getTime()+864e5,n.setTime(s),document.cookie=e.name[o]+"="+e.value[o]+";expires="+n.toUTCString()+";path=/"+("/"===this.args.path?"":this.args.path)+";domain="+this.args.domain+a+";SameSite=Lax"}},readCookieData:function(t){var e=[];return document.cookie.split(";").forEach(function(a){var[o,n]=a.split("="),s=o.trim();RegExp(t+"\\[\\d+\\]").test(s)&&e.push(n)}),e.join("a")},isLocalStorageAvailable:function(){var t;try{return(t=window.localStorage).setItem("__pvcStorageTest",0),t.removeItem("__pvcStorageTest"),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}},loadViews:function(){var t=document.getElementsByClassName("post-views");if(t.length>0)for(var e=0;e<t.length;e++){var a=t[e],o=a.className;if(o.includes("load-dynamic")){var n=RegExp("[a-zA-Z]+-[0-9]+.*?"),s=o.match(n),i="",r=0;{var c=s[0].split("-");i=c[0],r=c[1];let l={action:"pvcp-views-count",pvcp_nonce:this.args.nonceCount,type:i,ID:r},u={method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"},body:this.prepareRequestData(l)};a.classList.add("loading"),this.promise=fetch(this.args.adminAjax,u).then(function(t){if(!t.ok)throw Error(t.statusText);return t.text()}).then(function(t){try{if("string"==typeof t&&null!==t){var e=a.getElementsByClassName("post-views-count");e.length>0&&(e[0].innerText=t)}else console.log("Invalid string")}catch(o){console.log("Invalid JSON data")}}).catch(function(t){console.log("Invalid response")}).finally(function(){a.classList.add("loaded"),a.classList.remove("loading")})}}}}}).init(pvcpArgsFrontend)};document.addEventListener("DOMContentLoaded",initPostViewsCounterPro);